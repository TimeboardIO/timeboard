[
  {
    "name": "User can create project",
    "description": "Any user with role OWNER membership on current org can create projects",
    "target": "action == 'PROJECTS_CREATE'",
    "condition": "subject.currentOrganizationRole('OWNER') && environment.get('businessPolicyEvaluator').checkProjectByUserLimit(subject.getDetails())"
  },
  {
    "name": "User can create task in a project",
    "description": "Any user belonging to the project can create tasks in this project",
    "target": "action == 'TASKS_CREATE'",
    "condition": "resource.isMember(subject.getDetails()) && environment.get('businessPolicyEvaluator').checkTaskByProjectLimit(subject.getDetails(), resource)"
  },
  {
    "name": "Org owner can setup org",
    "description": "Only user with role OWNER on org can setup org",
    "target": "action == 'ORG_SETUP'",
    "condition": "subject.currentOrganizationRole('OWNER')"
  },
  {
    "name": "Org owner can archive project",
    "description": "Only user with role OWNER on org can archive project",
    "target": "action == 'PROJECTS_ARCHIVE'",
    "condition": "subject.currentOrganizationRole('OWNER') && resource.getOrganizationID() == subject.getCurrentOrganization()"
  },
  {
    "name": "Project owner can view snapshot",
    "description": "Only user with role OWNER on current project",
    "target": "action == 'PROJECT_SNAPSHOT'",
    "condition": "resource.isMember(subject.getDetails(), 'OWNER')"
  },
  {
    "name": "Project owner can view snapshot",
    "description": "Only user with role OWNER on current project",
    "target": "action == 'PROJECT_SNAPSHOT'",
    "condition": "resource.isMember(subject.getDetails(), 'OWNER')"
  }
]